syntax = "proto3";

option csharp_namespace = "WorkerProto";

service Worker {
    rpc DoWork(WorkRequest) returns (WorkReply);
}

enum TaskType {
    LIST_CERTS_UNSPECIFIED = 0;
    SIGN_HASH = 1;
    SIGN_PDF = 2;
}

message WorkRequest {
    TaskType Task = 1;
    SignerContext Context = 2;

    oneof payload {
        ListCertRequest list_cert = 3;
        SignHashRequest sign_hash = 4;
        SignPdfRequest sign_pdf = 5;
    }
}

message WorkReply {
    oneof result {
        ListCertReply list_cert = 1;
        SignHashReply sign_hash = 2;
        SignPdfReply sign_pdf = 3;
    }

  bool success = 10;          // true nếu thành công
  string error_message = 11;  // lỗi nếu có
}

// Context
message SignerContext {
    string Pin = 1;
    string DllPath = 2;
}

// Request
message ListCertRequest {

}

message SignHashRequest {
    string Thumprint = 3;
    string HashData = 4;
}

message SignPdfRequest {
     
}

// Reply
message SignHashReply {
    string Pin = 1;
}

message ListCertReply {
    string Pin = 1;
}

message SignPdfReply {
    string Pin = 1;
}